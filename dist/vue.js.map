{"version":3,"file":"vue.js","sources":["../src/compiler/codegen.js","../src/compiler/parse.js","../src/compiler/index.js","../src/gloablAPI.js","../src/observer/dep.js","../src/observer/watcher.js","../src/vdom/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //匹配花括号 {{  }} 捕获花括号里面的内容\n\n// 处理attrs属性\nfunction genProps(attrs) {\n  let str = '';\n  for (let i = 0; i < attrs.length; i++) {\n    let attr = attrs[i];\n    // 特殊属性 style\n    if (attr.name === 'style') {\n      const obj = {};\n      attr.value.split(';').reduce((memo, current) => {\n        const [key, value] = current.split(':');\n        memo[key] = value;\n        return memo;\n      }, obj);\n      attr.value = obj;\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`;\n  }\n  return `{${str.slice(0, -1)}}`;\n}\n\nfunction gen(node) {\n  if (node.type === 1) {\n    return generate(node);\n  } else {\n    const text = node.text;\n    if (!defaultTagRE.test(text)) {\n      return `_v(${JSON.stringify(text)})`; // 不带表达式\n    } else {\n      const tokens = [];\n      let match;\n      // exec 遇到全局匹配会有 lastIndex 问题，每次匹配谦虚要将lastIndex置为0\n      let startIndex = (defaultTagRE.lastIndex = 0);\n      while ((match = defaultTagRE.exec(text))) {\n        const endIndex = match.index; // 匹配到的索引 abc ｛｛aa｝｝ {{bb}} cd\n        if (endIndex > startIndex) {\n          tokens.push(JSON.stringify(text.slice(startIndex, endIndex)));\n        }\n        tokens.push(`_s(${match[1].trim()})`);\n        startIndex = endIndex + match[0].length;\n      }\n      if (startIndex < text.length) {\n        // 将最后的尾巴也丢进去\n        tokens.push(JSON.stringify(text.slice(startIndex)));\n      }\n      return `_v(${tokens.join('+')})`; // 组合成最终的语法\n    }\n  }\n}\n\n// 生成子节点，递归创建\nfunction genChildren(el) {\n  const children = el.children;\n  if (children) {\n    return `${children.map((child) => gen(child)).join(',')}`;\n  }\n}\n\nexport function generate(el) {\n  // 字符串拼接\n  const children = genChildren(el);\n  let code = `_c('${el.tag}',${\n    el.attrs.length ? `${genProps(el.attrs)}` : 'undefined'\n  }${children ? `,${children}` : ''})`; // _c('div', {className: 'xxx'}, _v('hello world'))\n  return code;\n}\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //匹配标签名 形如 abc-123\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //匹配特殊标签 形如 abc:234 前面的abc:可有可无\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配标签开始 形如 <abc-123 捕获里面的标签名\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束  >\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾 如 </abc-123> 捕获里面的标签名\nconst attribute =\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性  形如 id=\"app\"\n\nexport function parse(html) {\n  let root; // 树的操作，需要根据开始标签和结束标签产生一棵树\n  // 如何构建树的父子关系\n  let stack = [];\n  function createASTElement(tagName, attrs) {\n    return {\n      tag: tagName,\n      attrs,\n      children: [],\n      parent: null,\n      type: 1,\n    };\n  }\n  function start(tagName, attrs) {\n    const element = createASTElement(tagName, attrs);\n    if (root == null) {\n      root = element;\n    }\n    const parent = stack[stack.length - 1]; // 取到栈中最后一个\n    if (parent) {\n      element.parent = parent; // 让这个元素记住自己的父亲是谁\n      parent.children.push(element); // 让父亲记住儿子是谁\n    }\n    // 将原素放到栈中\n    stack.push(element);\n  }\n  function end(tagName) {\n    stack.pop();\n  }\n  function chars(text) {\n    text = text.replace(/\\s/g, '');\n    if (text) {\n      const parent = stack[stack.length - 1];\n      if (parent) {\n        // Check if parent exists\n        parent.children.push({\n          type: 3,\n          text,\n        });\n      }\n    }\n  }\n  function parseStartTag() {\n    const matches = html.match(startTagOpen);\n    if (matches) {\n      const match = {\n        tagName: matches[1],\n        attrs: [],\n      };\n      advance(matches[0].length);\n      // 继续解析开始标签的属性\n      let end, attr;\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        // 只要没有匹配到结束标签就一直匹配\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5] || true,\n        });\n        advance(attr[0].length); // 解析一个属性删除一个\n      }\n      if (end) {\n        advance(end[0].length);\n        return match;\n      }\n    }\n  }\n  function advance(n) {\n    html = html.substring(n); // 每次根据传入的长度截取html\n  }\n  while (html) {\n    // 一个个字符来解析将结果跑出去\n    let textEnd = html.indexOf('<');\n    if (textEnd === 0) {\n      const startTagMatch = parseStartTag(); // 解析开始标签\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs);\n        continue;\n      }\n      let matches;\n      if ((matches = html.match(endTag))) {\n        // </div> 不是开始就会走到结束\n        end(matches[1]);\n        advance(matches[0].length);\n        continue;\n      }\n    }\n    let text;\n    if (textEnd >= 0) {\n      text = html.substring(0, textEnd);\n    }\n    if (text) {\n      advance(text.length);\n      chars(text);\n    }\n  }\n  return root;\n}\n","import { generate } from './codegen';\nimport { parse } from './parse';\n\n// 将模板变成render函数，通过with+new Function的方式让字符串变成js语法来执行\nexport function compileToFunctions(template) {\n  const ast = parse(template);\n\n  // 通过ast语法树转换成render函数\n  const code = generate(ast);\n\n  // 使用with改变作用域为this\n  const renderFn = new Function(`with(this) {return ${code}}`);\n  return renderFn;\n}\n\n// 将template转换成ast语法树, 再将语法树转换成一个字符串拼接在一起\n// ast用来描述语言本身，语法中没有的，不会被描述出来\n// vdom描述真实dom元素，可以自己添加属性\n","export default function initGlobalAPI(Vue) {\n  Vue.options = {};\n  Vue.mixin = function (options) {\n    this.options = mergeOptions(this.options, options);\n    return this;\n  };\n}\n\nconst strats = {};\nconst LIFECYCLE = ['beforeCreate', 'created'];\n\nLIFECYCLE.forEach((hook) => {\n  strats[hook] = function (p, c) {\n    if (c) {\n      // 如果儿子有 父亲有 让父亲和儿子拼在一起\n      if (p) {\n        return p.concat(c); // 最终八生命周期都合并在一起了\n      } else {\n        return [c]; // 儿子有父亲没有 则将儿子包装秤数组\n      }\n    } else {\n      return p; // 如果儿子没有则用父亲即可\n    }\n  };\n});\n\nexport function mergeOptions(parent, child) {\n  const options = {};\n  for (let key in parent) {\n    // 循环老的\n    mergeField(key);\n  }\n  for (let key in child) {\n    if (!parent.hasOwnProperty(key)) {\n      mergeField(key);\n    }\n  }\n  function mergeField(key) {\n    // 策略模式 减少if-else\n    if (strats[key]) {\n      options[key] = strats[key](parent[key], child[key]);\n    } else {\n      // 如果不在测量中则以儿子为主\n      options[key] = child[key] || parent[key]; // 优先采用儿子 再采用父亲\n    }\n  }\n  return options;\n}\n","let id = 0;\nclass Dep {\n  constructor() {\n    this.id = id++; // 属性的dep要收集watcher\n    this.subs = []; // 这里存放着当前属性对应的watcher有哪些\n  }\n  depend() {\n    // 这里我们不希望放重复的watcher，而且刚才只是一个单向的关系 dep -> watcher\n    // watcher 记录dep\n    // this.subs.push(Dep.target);\n\n    Dep.target.addDep(this); // 让watcher记住dep\n\n    // dep 和 watcher是一个多对多的关系 （一个属性可以在多个组件中使用 dep -> 多个watcher）\n    // 一个组件中由多个属性组成 （一个watcher 对应多个dep）\n  }\n  addSub(watcher) {\n    this.subs.push(watcher);\n  }\n  notify() {\n    this.subs.forEach((watcher) => watcher.update()); // 告诉watcher要更新了\n  }\n}\nDep.target = null;\n\nexport default Dep;\n","import Dep from './dep';\n\nlet id = 0;\n\n// 1）当我们创建渲染watcher的时候我们会把当前的渲染watcher放到Dep.target上\n// 2) 调用_render() 会取值 走到get上\n// 每个属性有一个dep（属性就是被观察者）,watcher就是观察者（属性变化了会通知观察者来更新） -> 观察者模式\nclass Watcher {\n  // 不同组件有不同的watcher 目前只有一个渲染根实例的\n  constructor(vm, fn, options) {\n    this.id = id++;\n    this.renderWatcher = options; // 是一个渲染watcher\n    this.getter = fn; // getter意味着调用这个函数可以发生取值操作\n    this.deps = []; // 后续我们实现计算属性，和一些清理工作需要用到\n    this.depsId = new Set();\n    this.get();\n  }\n  addDep(dep) {\n    // 一个组件 对应着多个属性 重复的属性也不用记录\n    let id = dep.id;\n    if (!this.depsId.has(id)) {\n      this.deps.push(dep);\n      this.depsId.add(id);\n      dep.addSub(this); // watcher已经记住了dep了而且去重了，此时让dep也记住watcher\n    }\n  }\n  get() {\n    // debugger;\n    Dep.target = this; // 静态属性就是只有一份\n    this.getter(); // 会去vm上取值  vm._update(vm._render) 取name 和age\n    Dep.target = null; // 渲染完毕后就清空\n  }\n  update() {\n    queueWatcher(this); // 把当前的watcher 暂存起来\n    // this.get(); // 重新渲染\n  }\n  run() {\n    this.get(); // 渲染的时候用的是最新的vm来渲染的\n  }\n}\n\nlet queue = [];\nlet has = {};\nlet pending = false; // 防抖\nfunction flushSchedulerQueue() {\n  let flushQueue = queue.slice(0);\n  queue = [];\n  has = {};\n  pending = false;\n  flushQueue.forEach((q) => q.run()); // 在刷新的过程中可能还有新的watcher，重新放到queue中\n}\nfunction queueWatcher(watcher) {\n  const id = watcher.id;\n  if (!has[id]) {\n    queue.push(watcher);\n    has[id] = true;\n    // 不管我们的update执行多少次 ，但是最终只执行一轮刷新操作\n    if (!pending) {\n      nextTick(flushSchedulerQueue, 0);\n      pending = true;\n    }\n  }\n}\n\nlet callbacks = [];\nlet waiting = false;\nfunction flushCallbacks() {\n  let cbs = callbacks.slice(0);\n  waiting = false;\n  callbacks = [];\n  cbs.forEach((cb) => cb()); // 按照顺序依次执行\n}\n// nextTick 没有直接使用某个api 而是采用优雅降级的方式\n// 内部先采用的是promise（ie不兼容）MutationObserver(h5的api) 可以考虑ie专享的 setImmediate setTimeout\nlet timerFunc;\nif (Promise) {\n  timerFunc = () => {\n    Promise.resolve().then(flushCallbacks);\n  };\n} else if (MutationObserver) {\n  let observer = new MutationObserver(flushCallbacks); // 这里传入的回调是异步执行的\n  let textNode = document.createTextNode(1);\n  observer.observe(textNode, {\n    characterData: true,\n  });\n  timerFunc = () => {\n    textNode.textContent = 2;\n  };\n} else if (setImmediate) {\n  timerFunc = () => {\n    setImmediate(flushCallbacks);\n  };\n} else {\n  timerFunc = () => {\n    setTimeout(flushCallbacks);\n  };\n}\n// 异步任务分为两种,宏任务/微任务\n// 宏任务 setTimeout setImmediate(IE下支持性能优于setTimeout)\n// 微任务 promise.then mutationObserver\n// Vue在更新的时候希望尽快的更新页面 Promise.then MutationObserver setImmediate setImmediate\n// Vue3不再考虑兼容性问题了, 所以后续Vue3中直接使用Promise.then\nexport function nextTick(cb) {\n  // 先内部还是先用户的？\n  callbacks.push(cb); // 维护nextTick中的cakllback方法\n  if (!waiting) {\n    timerFunc();\n    // Promise.resolve().then(flushCallbacks);\n    waiting = true;\n  }\n}\n\n// 需要给每个属性增加一个dep， 目的就是收集watcher\n\n// 一个组件中 有多少个属性 （n个属性会对应一个视图） n个dep对应一个watcher\n// 1个属性 对应着多个组件  1个dep对应多个watcher\n// 多对多的关系\n\nexport default Watcher;\n","// 创建元素vnode 等于render函数里面的 h=>h(App)\nexport function createElement(vm, tag, data = {}, ...children) {\n  return vnode(vm, tag, data, children, data.key, null);\n}\n\n// 创建文本vnode\nexport function createTextNode(vm, text) {\n  return vnode(vm, undefined, undefined, undefined, undefined, text);\n}\n\nfunction vnode(vm, tag, data, children, key, text) {\n  return {\n    vm,\n    tag,\n    data,\n    children,\n    key,\n    text,\n    // ...\n  };\n}\n","function isSameVnode(n1, n2) {\n  // 如果两个人的标签和key 一样我认为是同一个节点 虚拟节点一样我就可以复用真实节点了\n  return n1.tag === n2.tag && n1.key === n2.key;\n}\n\nexport function createElm(vnode) {\n  const { tag, data, children, text } = vnode;\n  if (typeof tag === 'string') {\n    // 元素\n    vnode.el = document.createElement(tag);\n    patchProps(vnode.el, {}, data);\n    children.forEach((child) => {\n      vnode.el.appendChild(createElm(child)); // 递归渲染\n    });\n  } else {\n    // 文本\n    vnode.el = document.createTextNode(text);\n  }\n  return vnode.el;\n}\n\nfunction patchProps(el, oldProps = {}, props = {}) {\n  // 老的属性中有 新的没有 要删除老的\n  const oldStyles = oldProps.style || {};\n  const newStyles = props.style || {};\n  for (let key in oldStyles) {\n    // 老的样式有 新的没有则删除\n    if (!newStyles[key]) {\n      el.style[key] = '';\n    }\n  }\n  for (let key in oldProps) {\n    // 老的属性有 新的没有删除属性\n    if (!props[key]) {\n      el.removeAttribute(key);\n    }\n  }\n  for (let key in props) {\n    // 用新的覆盖老的\n    if (key === 'style') {\n      for (let styleName in props.style) {\n        el.style[styleName] = props.style[styleName];\n      }\n    } else {\n      el.setAttribute(key, props[key]);\n    }\n  }\n}\n\nfunction mountChildren(el, newChildren) {\n  for (let i = 0; i < newChildren.length; i++) {\n    let child = newChildren[i];\n    el.appendChild(createElm(child));\n  }\n}\n\nfunction patchVnode(oldVnode, vnode) {\n  // case1: 前后两个虚拟节点不是相同节点 直接替换掉即可\n  if (!isSameVnode(oldVnode, vnode)) {\n    return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el);\n  }\n  // 标签一样就复用节点\n  let el = (vnode.el = oldVnode.el);\n  // case2: 两个元素虚拟节点都是文本的情况下 用新文本替换到老文本\n  if (!oldVnode.tag) {\n    if (oldVnode.text !== vnode.text) {\n      return (el.textContent = vnode.text);\n    }\n  }\n  // case3: 两个都是标签 比对标签属性\n  patchProps(el, oldVnode.data, vnode.data);\n  // case4: 比较儿子节点 一方有儿子 一方没儿子 两方都有儿子\n  const oldChildren = oldVnode.children || [];\n  const newChildren = vnode.children || [];\n  if (oldChildren.length > 0 && newChildren.length > 0) {\n    // 完整diff算法 比对两个儿子 一层层比较, 不涉及夸级比较\n    updateChildren(el, oldChildren, newChildren);\n  } else if (newChildren.length > 0) {\n    // 没有老的 有新的\n    mountChildren(el, newChildren);\n  } else if (oldChildren.length > 0) {\n    // 新的没有 老的有 直接删除\n    el.innerHTML = ''; // 可以循环删除\n  }\n  return el;\n}\n\n// Vue2.0中采用双指针的方式比较两个节点\n// 操作列表经常会有push shift pop unshift reverse sort这些方法(针对镇邪情况做一些优化)\nfunction updateChildren(el, oldChildren, newChildren) {\n  // Vue中创建了4个指针 分别指向老孩子和新孩子的头尾\n  // 分别一次进行比较有一方先比较完毕就结束\n  let oldStartIndex = 0;\n  let newStartIndex = 0;\n  let oldEndIndex = oldChildren.length - 1;\n  let newEndIndex = newChildren.length - 1;\n\n  let oldStartVnode = oldChildren[0];\n  let newStartVnode = newChildren[0];\n  let oldEndVnode = oldChildren[oldEndIndex];\n  let newEndVnode = newChildren[newEndIndex];\n\n  function makeIndexByKey(children) {\n    const map = {};\n    children.forEach((child, index) => {\n      map[child.key] = index;\n    });\n    return map;\n  }\n  const map = makeIndexByKey(oldChildren);\n\n  // 有任何一个不满足则停止 || 有一个为true就继续走\n  // 双方有一方的头指针 大于尾部指针则停止循环\n  while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n    if (!oldStartVnode) {\n      oldStartVnode = oldChildren[++oldStartIndex];\n    } else if (!oldEndVnode) {\n      oldEndVnode = oldChildren[--oldEndIndex];\n    } else if (isSameVnode(oldStartVnode, newStartVnode)) {\n      // 说明两个是同一个元素 要比较属性和它的儿子\n      patchVnode(oldStartVnode, newStartVnode);\n      oldStartVnode = oldChildren[++oldStartIndex];\n      newStartVnode = newChildren[++newStartIndex];\n      // 比较开头节点\n    } else if (isSameVnode(oldEndVnode, newEndVnode)) {\n      // 说明两个是同一个元素 要比较属性和它的儿子\n      patchVnode(oldEndVnode, newEndVnode);\n      oldEndVnode = oldChildren[--oldEndIndex];\n      newEndVnode = newChildren[--newEndIndex];\n      // 比较结尾节点\n    } else if (isSameVnode(oldEndVnode, newStartVnode)) {\n      patchVnode(oldEndVnode, newStartVnode);\n      // insertBefore具备移动性 会将原来的元素移动走\n      el.insertBefore(oldEndVnode.el, oldStartVnode.el); // 将老的尾巴移动到老的前面去\n      oldEndVnode = oldChildren[--oldEndIndex];\n      newStartVnode = newChildren[++newStartIndex];\n      // 比较尾头节点\n    } else if (isSameVnode(oldStartVnode, newEndVnode)) {\n      patchVnode(oldStartVnode, newEndVnode);\n      // insertBefore具备移动性 会将原来的元素移动走\n      el.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling); // 将老的尾巴移动到老的后面去\n      oldStartVnode = oldChildren[++oldStartIndex];\n      newEndVnode = newChildren[--newEndIndex];\n      // 比较头尾节点\n    } else {\n      // 根据老的列表做一个映射关系 用新的去找 找到则移动 找不到则添加 最后多余的删除\n      // 给动态列表添加key的时候 要尽量避免使用索引 因为索引前后都是从0开始 可能会发生错误复用\n      const moveIndex = map[newStartVnode.key]; // 如果拿到则说明是要移动的索引\n      if (moveIndex !== undefined) {\n        const moveVnode = oldChildren[moveIndex]; // 找到对应的虚拟节点 复用\n        el.insertBefore(moveVnode.el, oldStartVnode.el);\n        oldChildren[moveIndex] = undefined; // 表示这个节点已经移动走了\n        patchVnode(moveVnode, newStartVnode); // 比对属性和子节点\n      } else {\n        el.insertBefore(createElm(newStartVnode), oldStartVnode.el);\n      }\n      newStartVnode = newChildren[++newStartIndex];\n      // 乱序比对\n    }\n  }\n  if (newStartIndex <= newEndIndex) {\n    // 新的多了 多余的就插入进去\n    for (let i = newStartIndex; i <= newEndIndex; i++) {\n      const childEl = createElm(newChildren[i]);\n      // 这里可能向后追加 还可能是向前追加\n      let anchor = newChildren[newEndIndex + 1]\n        ? newChildren[newEndIndex + 1].el\n        : null; // 获取下一个元素\n      el.insertBefore(childEl, anchor); // anchor为null的时候则会认为是appendChild\n    }\n  }\n  if (oldStartIndex <= oldEndIndex) {\n    // 老的多了 需要删除老的\n    for (let i = oldStartIndex; i <= oldEndIndex; i++) {\n      if (oldChildren[i]) {\n        const childEl = oldChildren[i].el;\n        el.removeChild(childEl);\n      }\n    }\n  }\n}\n\nexport function patch(oldVnode, vnode) {\n  // oldVnode可能是后续做虚拟节点的时候，是两个虚拟节点的比较\n  const isRealElement = oldVnode.nodeType; // 如果有说明是一个dom元素\n  if (isRealElement) {\n    // 初次渲染\n    const oldElm = oldVnode;\n    // 需要获取父节点，将当前的节点的下一个节点作为参照物，将它插入，之后删除老节点\n    const parentNode = oldElm.parentNode; // 父节点\n    const el = createElm(vnode); // 根据虚拟节点转换成真实dom节点\n    // 插入到老的el节点下一个节点的前面，就相当于插入到老的el节点的后面\n    // 这里不直接使用父元素appendChild是为了不破坏替换的位置\n    parentNode.insertBefore(el, oldElm.nextSibling);\n    // 删除老的el节点\n    parentNode.removeChild(oldElm);\n    return el;\n  } else {\n    // 1.两个节点不是同一个节点 直接删除老的换上新的(没有比对)\n    // 2.两个节点是同一个节点(判断节点的tag和节点的key) 比较两个节点的属性是否有差异(复用老节点 将差异的属性更新)\n    // 3.节点比较完毕后就需要比较两个的儿子了\n    patchVnode(oldVnode, vnode);\n    return vnode.el;\n  }\n}\n\n// 1.每次更新页面的话，dom结构不会变，调用render方法时，数据变化了会根据数据渲染成新的虚拟节点，用新的虚拟节点渲染dom\n// 2.Vue3采用了最长递增子序列 找到最长不需要移动的序列 从而减少了移动操作\n","import Watcher from './observer/watcher';\nimport { createElement, createTextNode } from './vdom/index';\nimport { patch } from './vdom/patch';\n\nexport function callHook(vm, hook) {\n  const handlers = vm.$options[hook];\n  if (handlers) {\n    for (let i = 0; i < handlers.length; i++) {\n      handlers[i].call(vm);\n    }\n  }\n}\n\n// 创建对应的虚拟节点，进行渲染\nexport function lifeCycleMixin(Vue) {\n  Vue.prototype._c = function () {\n    return createElement(this, ...arguments);\n  };\n  Vue.prototype._v = function () {\n    return createTextNode(this, ...arguments);\n  };\n  Vue.prototype._s = function (value) {\n    if (typeof value === 'object' && value != null) {\n      return JSON.stringify(value); // 将数据转换成字符串，因为使用的变量对应的结果可能是一个对象\n    }\n    return value;\n  };\n  Vue.prototype._render = function () {\n    const vm = this;\n    const render = vm.$options.render;\n    const vnode = render.call(vm);\n    return vnode;\n  };\n  Vue.prototype._update = function (vnode) {\n    // 将虚拟节点变成真实节点\n    // 将vnode渲染到el元素中\n    const vm = this;\n    const prevVnode = vm._vnode; // 上一次的vNode\n    if (!prevVnode) {\n      vm.$el = patch(vm.$el, vnode); // 可以初始化渲染，后续更新也走这个patch方法\n    } else {\n      vm.$el = patch(prevVnode, vnode);\n    }\n    vm._vnode = vnode; // 渲染完毕后重新更新vnode\n  };\n}\n\n// 将模板ast => render => render函数产生虚拟节点（数据得是渲染好的）\n//                |________________|\nexport function mountComponent(vm, el) {\n  // 实现页面的挂载流程\n  vm.$el = el; // 先将el挂载到实例上\n  const updateComponent = () => {\n    // 需要调用生成的render函数，获取到虚拟节点，生成真实节点\n    vm._update(vm._render());\n  };\n  new Watcher(\n    vm,\n    updateComponent,\n    () => {\n      console.log('页面传喔国内新渲染 updated');\n    },\n    true\n  );\n  // updateComponent(); // 如果稍后数据变化，也调用这个函数重新执行\n  // 观察者模式 + 依赖收集 + diff算法\n}\n","// 获取数组原型\nlet oldArrayPrototype = Array.prototype;\n// arrayPrototype.__proto__ = Array.prototype\nlet arrayPrototype = Object.create(oldArrayPrototype);\n// 数组变异方法\nlet methods = ['push', 'pop', 'shift', 'unshift', 'splice', 'reverse', 'sort'];\nmethods.forEach((method) => {\n  // 用户调用push方法会先自己重写的方法, 之后调用数组原来的方法\n  arrayPrototype[method] = function (...args) {\n    // 需要对新增的数据再次进行劫持\n    let inserted;\n    const ob = this.__ob__;\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args; // 数组\n        break;\n      case 'splice': // arr.splice(1, 1, xxx)\n        inserted = args.slice(2);\n        break;\n      default:\n        break;\n    }\n    if (inserted) {\n      // 对新增的数据再次进行观测\n      ob.observeArray(inserted);\n    }\n    const result = oldArrayPrototype[method].call(this, ...args);\n    ob.dep.notify(); // 数据变化了, 通知对应的watcher实现更新逻辑\n    return result;\n  };\n});\n\nexport default arrayPrototype;\n","import arrayPrototype from './array';\nimport Dep from './dep';\n\n// 1.给每个对象和数组也增加dep属性\n// 2.当页面取值的时候会执行get方法, 拿到刚才新增的dep属性, 让它记住这个watcher\n// 3.稍后数据变化, 触发当前数组的dep中存放的watcher去更新\n\nclass Observer {\n  constructor(data) {\n    this.dep = new Dep(); // 给所有的对象都增加一个dep,后续会给对象增添新的属性也希望能实现更新\n    // 如果有__ob__属性, 说明被观测过了\n    Object.defineProperty(data, '__ob__', {\n      value: this,\n      enumerable: false, // 不可枚举(循环的时候无法获取到)\n      writable: true,\n      configurable: true,\n    });\n    if (Array.isArray(data)) {\n      // 如果是数组的话也是用defineProperty会浪费很多性能, 并且很少用户会通过索引操作 arr[666] = 777\n      // vue3中的Polyfill直接就给数组做代理了\n      // 改写数组的方法, 用户调用了可以改写数组方法的api, 那么就去劫持这个方法\n      // 变异方法 push pop shift unshift reverse sort splice\n      // 修改数组的索引和长度无法更新视图\n      data.__proto__ = arrayPrototype;\n      // 如果数组里面放的是对象类型, 期望它也会被变成响应式的\n      this.observeArray(data);\n    } else {\n      this.walk(data);\n    }\n  }\n  observeArray(data) {\n    data.forEach((item) => observe(item)); // 如果是对象才观测\n  }\n  walk(data) {\n    // 循环对象, 尽量不用for in 会遍历原型链\n    let keys = Object.keys(data);\n    keys.forEach((key) => {\n      // 没有重写数组里的每一项\n      defineReactive(data, key, data[key]);\n    });\n  }\n}\n\n// 深层次嵌套会递归, 递归多了性能差, 不粗案子属性监控不到, 存在的属性要重写方法\nfunction dependArray(value) {\n  for (let i = 0; i < value.length; i++) {\n    let current = value[i];\n    current.__ob__ && current.__ob__.dep.depend();\n    if (Array.isArray(current)) {\n      dependArray(current);\n    }\n  }\n}\n\n// 性能不好的原因, 所有的属性都被重新定义了一遍\n// 一上来需要将对象深度代理, 性能差\n// 闭包 属性劫持\nfunction defineReactive(data, key, value) {\n  const childOb = observe(value); // 递归代理属性, childOb就是当前的实例\n  // 属性会全部被重写添加了get和set\n  let dep = new Dep(); // 每一个属性都有一个dep\n  Object.defineProperty(data, key, {\n    // 取值的时候 会执行get\n    get() {\n      if (Dep.target) {\n        dep.depend(); // 让这个属性的收集器记住当前的watcher\n        if (childOb) {\n          childOb.dep.depend(); // 让数组和对象本身也实现依赖收集\n          if (Array.isArray(value)) {\n            dependArray(value);\n          }\n        }\n      }\n      return value;\n    },\n    // 修改的时候 会执行set\n    set(newValue) {\n      // 修改的时候 会执行set\n      if (newValue === value) return;\n      observe(newValue);\n      value = newValue;\n      dep.notify(); // 通知更新\n    },\n  });\n}\n\nexport function observe(data) {\n  if (typeof data !== 'object' || data == null) {\n    // 如果不是对象类型, 那么不需要做任何处理\n    return;\n  }\n  if (data.__ob__ instanceof Observer) {\n    // 说明这个属性已经被代理过了\n    return data.__ob__;\n  }\n  // 如果一个对象已经被观测了, 就不要再次被观测了\n  // __ob__ 标识是否又被观测过\n  return new Observer(data);\n}\n\n// 总结:\n// 1.在Vue2中对象响应式原理, 就是给每个属性增加get和set, 而且递归操作(用户在写代码的时候尽量不要把所有属性都放在data中, 层次尽可能不要太深), 赋值一个新对象也会被变成响应式\n// 2.数组没有使用defineProperty, 采用的是函数劫持创造一个新的原型重写了这个原型的7个方法, 用户在调用的时候采用的是这7个方法, 增加了逻辑如果是新增的数据会再次被劫持, 最终调用数组的原有方法(注意数字的索引和长度没有被监控), 数组中对象类型会被进行响应式处理\n\n// 补充:\n// 1.每个类头有一个prototype指向了一个公共的空间\n// 2.每个实例可以通过__proto__找到所属类的prototype对应的内容\n","import { observe } from './observer/index';\n\nexport function initState(vm) {\n  // 获取传入的数据对象\n  const options = vm.$options;\n\n  // 后续实现计算属性 watch props methods\n  if (options.data) {\n    // 初始化data\n    initData(vm);\n  }\n}\n\nfunction proxy(vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key];\n    },\n    set(newValue) {\n      vm[source][key] = newValue;\n    },\n  });\n}\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n  // 如果是函数就拿到函数的返回值, 否则就直接采用data作为数据源\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data;\n  // 期望用户可以直接通过 vm.xxx 获取值, 也可以这样取值 vm._data.xxx\n  for (let key in data) {\n    proxy(vm, '_data', key);\n  }\n  // 属性劫持, 采用defineProperty将所有的属性进行劫持\n  observe(data);\n}\n","import { compileToFunctions } from './compiler/index';\nimport { mergeOptions } from './gloablAPI';\nimport { callHook, mountComponent } from './lifecycle';\nimport { initState } from './state';\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    // vue中会判断如果是$开头的属性不会被变成响应式数据\n    this.$options = mergeOptions(vm.constructor.options, options); // 所有后续的扩展方法都有一个$options选项可以获取用户的所有选项\n\n    // 对于实例的数据源 props data methods computed watch\n    // prop data\n    callHook(vm, 'beforeCreate');\n    initState(vm);\n    callHook(vm, 'created');\n\n    // 状态初始化完毕后需要进行页面挂载\n    if (vm.$options.el) {\n      // el属性和直接调用$mount是一样的\n      vm.$mount(vm.$options.el);\n    }\n  };\n  Vue.prototype.$mount = function (el) {\n    const vm = this;\n    el = document.querySelector(el);\n    const options = vm.$options;\n    if (!options.render) {\n      let template = options.template;\n      if (!template && el) {\n        template = el.outerHTML;\n      }\n      // 将template变成render函数\n      // 创建render函数 => 虚拟dom => 渲染真实dom\n      const render = compileToFunctions(template); // 开始编译\n      options.render = render;\n    }\n    // 将当前组件实例挂载到真实的el节点上面\n    return mountComponent(vm, el);\n  };\n}\n\n// diff算法, 主要是两个虚拟节点的比对, 需要根据模板渲染出一个render函数, render函数可以返回一个虚拟节点, 数据更新了重新调用render函数, 可以再返回一个虚拟节点\n","// 整个自己编写的Vue入口\n\nimport { compileToFunctions } from './compiler/index';\nimport initGlobalAPI from './gloablAPI';\nimport { initMixin } from './init';\nimport { lifeCycleMixin } from './lifecycle';\nimport { nextTick } from './observer/watcher';\nimport { createElm, patch } from './vdom/patch';\n\n// es6的类, 要求所有的扩展都在类的内部来进行扩展\n\nfunction Vue(options) {\n  this._init(options);\n}\n\ninitMixin(Vue); // 后续再扩展都可以采用这种方式\nlifeCycleMixin(Vue);\ninitGlobalAPI(Vue);\n\nVue.prototype.$nextTick = nextTick;\n\n// ------------- 为了方便观察前后的虚拟节点-- 测试的-----------------\nlet vm0 = new Vue({\n  data: {\n    name: 'pf',\n    age: 22,\n  },\n});\nlet render0 = compileToFunctions(\n  `<div class=\"a\" style=\"color: lightblue;\" b=\"1\"><span>{{name}}</span><span>{{age}}</span></div>`\n);\nlet oldVnode = render0.call(vm0);\nlet ele = createElm(oldVnode);\ndocument.body.appendChild(ele);\n\nlet vm = new Vue({\n  data: {\n    message: 'hello world',\n  },\n});\nlet render = compileToFunctions(\n  `<div class=\"b\" style=\"color: red\" c=33><span>{{message}}</span></div>`\n);\nlet newVnode = render.call(vm);\n\nlet render1 = compileToFunctions(`<ul  a=\"1\" style=\"color:blue\">\n    <li key=\"A\">a</li>\n    <li key=\"B\">b</li>\n    <li key=\"C\">c</li>\n    <li key=\"D\">d</li>\n</ul>`);\nlet vm1 = new Vue({ data: { name: 'pf' } });\nlet prevVnode = render1.call(vm1);\nlet el = createElm(prevVnode);\ndocument.body.appendChild(el);\n\nlet render2 = compileToFunctions(`<ul  a=\"1\"  style=\"color:red;\">\n    <li key=\"C\">c</li>\n    <li key=\"A\">a</li>\n    <li key=\"D\">d</li>\n    <li key=\"E\">e</li>\n    <li key=\"Q\">q</li>\n</ul>`);\nlet vm2 = new Vue({ data: { name: 'zf' } });\nlet nextVnode = render2.call(vm2);\n\n// 直接将新的节点替换掉了老的，不是直接替换 而是比较两个人的区别之后在替换 diff算法\n// diff算法是一个平级比较的过程 父亲和父亲比对，儿子和儿子比对\n// 主要比对标签名和key来判断是不是同一个元素, 如果标签和key都一样说明两个元素使同一个元素\nsetTimeout(() => {\n  // patch(oldVnode, newVnode);\n\n  patch(prevVnode, nextVnode);\n}, 2000);\n\n// 给Vue添加原型方法我们通过文件的方式来添加, 防止所有的功能都在一个文件中来处理\nexport default Vue;\n"],"names":["defaultTagRE","genProps","attrs","str","i","length","attr","name","obj","value","split","reduce","memo","current","_current$split","_current$split2","_slicedToArray","key","concat","JSON","stringify","slice","gen","node","type","generate","text","test","tokens","match","startIndex","lastIndex","exec","endIndex","index","push","trim","join","genChildren","el","children","map","child","code","tag","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","attribute","parse","html","root","stack","createASTElement","tagName","parent","start","element","end","pop","chars","replace","parseStartTag","matches","advance","n","substring","textEnd","indexOf","startTagMatch","compileToFunctions","template","ast","renderFn","Function","initGlobalAPI","Vue","options","mixin","mergeOptions","strats","LIFECYCLE","forEach","hook","p","c","mergeField","hasOwnProperty","id","Dep","_classCallCheck","subs","_createClass","depend","target","addDep","addSub","watcher","notify","update","Watcher","vm","fn","renderWatcher","getter","deps","depsId","Set","get","dep","has","add","queueWatcher","run","queue","pending","flushSchedulerQueue","flushQueue","q","nextTick","callbacks","waiting","flushCallbacks","cbs","cb","timerFunc","Promise","resolve","then","MutationObserver","observer","textNode","document","createTextNode","observe","characterData","textContent","setImmediate","setTimeout","createElement","data","arguments","undefined","_len","Array","_key","vnode","isSameVnode","n1","n2","createElm","patchProps","appendChild","oldProps","props","oldStyles","style","newStyles","removeAttribute","styleName","setAttribute","mountChildren","newChildren","patchVnode","oldVnode","parentNode","replaceChild","oldChildren","updateChildren","innerHTML","oldStartIndex","newStartIndex","oldEndIndex","newEndIndex","oldStartVnode","newStartVnode","oldEndVnode","newEndVnode","makeIndexByKey","insertBefore","nextSibling","moveIndex","moveVnode","childEl","anchor","removeChild","patch","isRealElement","nodeType","oldElm","callHook","handlers","$options","call","lifeCycleMixin","prototype","_c","apply","_v","_s","_typeof","_render","render","_update","prevVnode","_vnode","$el","mountComponent","updateComponent","console","log","oldArrayPrototype","arrayPrototype","Object","create","methods","method","_oldArrayPrototype$me","inserted","ob","__ob__","args","observeArray","result","Observer","defineProperty","enumerable","writable","configurable","isArray","__proto__","walk","item","keys","defineReactive","dependArray","childOb","set","newValue","initState","initData","proxy","source","_data","initMixin","_init","constructor","$mount","querySelector","outerHTML","$nextTick","vm0","age","render0","ele","body","message","render1","vm1","render2","vm2","nextVnode"],"mappings":"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"}